!function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define(b):a.crel=b()}(this,function(){function a(){var d,l=arguments,m=l[0],p=l[1],q=2,r=l.length,s=a[g];if(m=a[i](m)?m:j.createElement(m),1===r)return m;if((!k(p,c)||a[h](p)||n(p))&&(--q,p=null),r-q===1&&k(l[q],"string")&&void 0!==m[e])m[e]=l[q];else for(;r>q;++q)if(d=l[q],null!=d)if(n(d))for(var t=0;t<d.length;++t)o(m,d[t]);else o(m,d);for(var u in p)if(s[u]){var v=s[u];typeof v===b?v(m,p[u]):m[f](v,p[u])}else m[f](u,p[u]);return m}var b="function",c="object",d="nodeType",e="textContent",f="setAttribute",g="attrMap",h="isNode",i="isElement",j=typeof document===c?document:{},k=function(a,b){return typeof a===b},l=typeof Node===b?function(a){return a instanceof Node}:function(a){return a&&k(a,c)&&d in a&&k(a.ownerDocument,c)},m=function(b){return a[h](b)&&1===b[d]},n=function(a){return a instanceof Array},o=function(b,c){a[h](c)||(c=j.createTextNode(c)),b.appendChild(c)};return a[g]={},a[i]=m,a[h]=l,"undefined"!=typeof Proxy&&(a.proxy=new Proxy(a,{get:function(b,c){return!(c in a)&&(a[c]=a.bind(null,c)),a[c]}})),a});var src,dst,buffer,wrapper=crel("div",{id:"wrapper"}),stage=crel("canvas",{id:"stage",width:"512",height:"512"}),image=crel("canvas",{width:512,height:512});crel(document.body,crel(wrapper,stage)),window.receiveJavaScript=function(a,b){};var img=new Image;img.src="./image.jpg",img.onload=function(){image.getContext("2d").drawImage(img,0,0),setTimeout(function(){window.indicator.stop(),wrapper.style.opacity=1,src=new Uint8Array(Module.HEAPU8.buffer,Module._malloc(img.width*img.height<<2),img.width*img.height<<2),src.set(new Uint8Array(image.getContext("2d").getImageData(0,0,img.width,img.height).data.buffer)),dst=new Uint8Array(Module.HEAPU8.buffer,Module._malloc(img.width*img.height<<2),img.width*img.height<<2),buffer=Module._malloc(1024),Module.writeStringToMemory(JSON.stringify({}),buffer),Module.cwrap("setup","void",["number"])(buffer),Module.cwrap("data","void",["number"])(src.byteOffset),Module.cwrap("processimage","void",["number"])(dst.byteOffset);var a=stage.getContext("2d").getImageData(0,0,img.width,img.height);a.data.set(dst),stage.getContext("2d").putImageData(a,0,0),setInterval(function(){Module.cwrap("processimage","void",["number"])(dst.byteOffset);var a=stage.getContext("2d").getImageData(0,0,img.width,img.height);a.data.set(dst),stage.getContext("2d").putImageData(a,0,0)},1e3/24)},50)};var _target=null;window.gui=window.gui||{callback:void 0},window.gui.isTouch="ontouchstart"in window;var mouseup=function(a){a.preventDefault(),window.gui.callback=void 0},mousemove=function(a){a.preventDefault(),window.gui.callback&&(window.gui.isTouch&&(a=a.touches[0]),window.gui.callback(window.gui.clientX+(a.screenX-window.gui.screenX)))};window.gui.isTouch?(window.addEventListener("touchend",mouseup,!1),window.addEventListener("touchcancel",mouseup,!1),window.addEventListener("touchmove",mousemove,!1)):(window.addEventListener("mouseup",mouseup,!1),window.addEventListener("mousemove",mousemove,!1));var timer=0,onResize=function(a){timer&&(clearTimeout(timer),timer=0),timer=setTimeout(function(){window.innerWidth<512?(stage.style.height=stage.style.width=document.documentElement.offsetWidth+"px",stage.style.marginLeft=0):(stage.style.height=stage.style.width="512px",stage.style.marginLeft=(document.documentElement.offsetWidth-512>>1)+"px");var a=stage.offsetHeight;window.innerHeight>a?(wrapper.style.marginTop=(window.innerHeight-32-a>>1)+"px",document.body.style.overflowY="hidden"):(wrapper.style.marginTop=0,document.body.style.overflowY="auto"),timer=0},50)};window.addEventListener("resize",onResize),onResize();